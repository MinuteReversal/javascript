<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <title>A4五角星底纹</title>
  <style>
    @page {
      size: A4;
      /* A4 纸大小 */
      margin: 0;
      /* 隐藏网址等信息 */
    }

    /* 打印时对元素的控制 */
    @media print {

      html,
      body {
        width: 210mm;
        /*毫米*/
        height: auto;
        /*毫米*/
      }

      /* ... the rest of the rules ... */
    }

    html,
    body {
      height: 297mm;
      width: 210mm;
      margin: 0;
      padding: 0;
      background: #fff;
    }

    body {
      position: relative;
      height: 297mm;
      width: 210mm;
      box-sizing: border-box;
      overflow: hidden;
      -webkit-print-color-adjust: exact;
      /* 打印背景色 */
      print-color-adjust: exact;
      /* 打印背景色 */
    }

    .star-bg {
      position: absolute;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      z-index: 0;
    }

    .controls {
      position: absolute;
      top: 16px;
      left: 16px;
      background: rgba(255, 255, 255, 0.8);
      padding: 12px 16px;
      border-radius: 8px;
      z-index: 10;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
    }

    @media print {
      .controls {
        display: none !important;
      }

      body {
        background: var(--print-bg, #ffff00) !important;
        -webkit-print-color-adjust: exact;
        print-color-adjust: exact;
        overflow: hidden;
      }

      html,
      body {
        background: unset !important;
      }
    }
  </style>
</head>

<body>
  <div class="controls">
    <label>
      背景色
      <input type="color" id="bgColor" value="#ffff00">
    </label>
    <label style="margin-left:16px;">
      底纹色
      <input type="color" id="starColor" value="#e0e0e0">
    </label>
    <label style="margin-left:16px;">
      底纹符号
      <input type="text" id="symbolInput" value="★" maxlength="2" style="width:2em;text-align:center;">
    </label>
    <button onclick="window.print()" style="margin-left:16px;">打印</button>
  </div>
  <canvas class="star-bg" id="starCanvas" width="794" height="1123"></canvas>
  <script>
    // 自动适应A4页面尺寸
    function resizeCanvas() {
      const rect = document.body.getBoundingClientRect();
      canvas.width = Math.round(rect.width);
      canvas.height = Math.round(rect.height);
      drawPattern();
    }

    let backgroundColor = "#ffff00";
    let starFillColor = "#e0e0e0";
    let symbol = "★";

    function setBackground(color) {
      backgroundColor = color;
      document.body.style.setProperty('--print-bg', color);
      document.documentElement.style.setProperty('--print-bg', color);
    }

    setBackground(backgroundColor);

    const canvas = document.getElementById('starCanvas');
    const ctx = canvas.getContext('2d');

    function drawStar(cx, cy, spikes, outerRadius, innerRadius, color, alpha) {
      let rot = Math.PI / 2 * 3;
      let x = cx;
      let y = cy;
      let step = Math.PI / spikes;

      ctx.save();
      ctx.beginPath();
      ctx.moveTo(cx, cy - outerRadius);
      for (let i = 0; i < spikes; i++) {
        x = cx + Math.cos(rot) * outerRadius;
        y = cy + Math.sin(rot) * outerRadius;
        ctx.lineTo(x, y);
        rot += step;

        x = cx + Math.cos(rot) * innerRadius;
        y = cy + Math.sin(rot) * innerRadius;
        ctx.lineTo(x, y);
        rot += step;
      }
      ctx.closePath();
      ctx.globalAlpha = alpha;
      ctx.fillStyle = color;
      ctx.fill();
      ctx.restore();
    }

    function drawSymbol(cx, cy, color, alpha) {
      ctx.save();
      ctx.globalAlpha = alpha;
      ctx.font = "24px sans-serif";
      ctx.textAlign = "center";
      ctx.textBaseline = "middle";
      ctx.fillStyle = color;
      ctx.fillText(symbol, cx, cy);
      ctx.restore();
    }

    // 底纹参数
    const starSize = 18;
    const starInner = 7;
    const gapX = 40;
    const gapY = 40;
    const alpha = 0.25;

    function drawPattern() {
      ctx.save();
      ctx.globalAlpha = 1;
      ctx.fillStyle = backgroundColor;
      ctx.fillRect(0, 0, canvas.width, canvas.height);
      ctx.restore();

      for (let y = gapY / 2; y < canvas.height; y += gapY) {
        for (let x = gapX / 2; x < canvas.width; x += gapX) {
          if (symbol === "★") {
            drawStar(x, y, 5, starSize, starInner, starFillColor, alpha);
          } else {
            drawSymbol(x, y, starFillColor, alpha);
          }
        }
      }
    }

    document.getElementById('bgColor').addEventListener('input', function (e) {
      backgroundColor = e.target.value;
      setBackground(backgroundColor);
      drawPattern();
    });
    document.getElementById('starColor').addEventListener('input', function (e) {
      starFillColor = e.target.value;
      drawPattern();
    });
    document.getElementById('symbolInput').addEventListener('input', function (e) {
      symbol = e.target.value || "★";
      drawPattern();
    });

    window.addEventListener('resize', resizeCanvas);
    resizeCanvas();
  </script>
</body>

</html>