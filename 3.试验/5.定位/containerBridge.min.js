function AjaxOptions(e,t,n,o){this.EnumMethodType={GET:"GET",POST:"POST"},this.url="",this.method=this.EnumMethodType.GET,this.data=null,this.cache=!0,e&&(this.ur=e),t&&(this.method=t),n&&(this.data=n),o&&(this.onComplete=o)}function AppOptions(e,t){this.appId="",this.appSecret="",e&&(this.appId=e),t&&(this.appSecret=t)}function ScanOptions(){this.scanType=ScanType.qrCode}function BridgeLogger(){}function NotImplementException(e){Error.call(this),this.message="Not Implement!",e&&(this.message=e)}function UnSupportedException(e){Error.call(this),this.message=e}function ArgumentException(e){Error.call(this),this.message=e}function IjsBridge(){}function ListenerItem(e,t){this.type="",this.listener=function(e){console.log(e)},e&&(this.type=e),t&&(this.listener=t)}function AjsBridge(){IjsBridge.call(this),this.appOptions=null,this.version="1.1",this.logger=new BridgeLogger,this.Listeners=[]}function AlipayBridge(){AjsBridge.call(this);var e=this;e.ContainerType=ContainerType.Alipay,e._listenAlipayReady();var t=document.createElement("script");t.addEventListener("load",function(t){"undefined"==typeof AlipayJSBridge&&e.logger.write("not find AlipayJSBridge object!")}),document.querySelector("head").insertBefore(t,null),t.src=ContainerBridgeConfig.alipayJsUrl}function AndroidBridge(){AjsBridge.call(this);var e=this;if(e.ContainerType=ContainerType.Android,e.options=null,"undefined"==typeof device)throw new Error("Not find interface");e._andriodReady()}function getQRcodeResult(e){ContainerBridge.options.complete(JSON.parse(e).QRCodeResult)}function H5Bridge(){AjsBridge.call(this);var e=this;e.ContainerType=ContainerType.PC,window.addEventListener("load",function(){e._h5Ready()})}function IosBridge(){AjsBridge.call(this);var e=this;e.options=null,this.ContainerType=ContainerType.iOS,window.addEventListener("load",function(){if("undefined"==typeof JSModel)throw new Error("Not find interface");e._iosReady()})}function onScanComplete(e){ContainerBridge.options.complete(e.qrValue)}function WechatBridge(){AjsBridge.call(this);var e=this;e.ContainerType=ContainerType.Wechat,e.appOptions=new AppOptions(ContainerBridgeConfig.wechatAppID,ContainerBridgeConfig.wechatAppSecret);try{var t=document.createElement("script");t.addEventListener("load",function(){"undefined"==typeof wx&&e.logger.write("Not find wechat Inerface!"),e._listenWechatError(),e._onWechatReady(),e._remoteGetConfig()}),document.querySelector("head").appendChild(t),t.src=ContainerBridgeConfig.wechatJsUrl}catch(n){e.logger.write(n.message)}}function RelBridge(){AjsBridge.call(this);var e=this;e.ContainerType=ContainerType.Rel;try{var t=document.createElement("script");t.addEventListener("load",function(t){"undefined"==typeof rel&&e.logger.write("Not find rel Inerface!"),e._listenrelError(),e._relReady(),e._remoteGetConfig()}),document.querySelector("head").appendChild(t),t.src=ContainerBridgeConfig.relJsUrl}catch(n){e.logger.write(n.message)}}function MobileBridge(){AjsBridge.call(this);var e=this;e.ContainerType=ContainerType.Mobile,window.addEventListener("load",function(){e._MobileReady()})}function BridgeFactory(){}AjaxOptions.prototype.onComplete=function(e){},AjaxOptions.prototype.onSuccess=function(e){},AjaxOptions.prototype.onError=function(e){},ScanOptions.prototype.onComplete=function(e){console.log(e)},BridgeLogger.prototype.write=function(e){ContainerBridgeConfig.debug&&(console.log(e),alert(e))};var BridgeEventType={ready:"ready"};NotImplementException.prototype=Object.create(Error.prototype),UnSupportedException.prototype=Object.create(Error.prototype),ArgumentException.prototype=Object.create(Error.prototype);var BridgeEventType={ready:"ready"},ContainerType={Wechat:"Wechat",Alipay:"Alipay",Android:"Android",WindowsPhone:"WindowsPhone",iOS:"iOS",PC:"PC",Rel:"rel",Mobile:"Mobile"},ScanType={barCode:"barCode",qrCode:"qrCode",cardNumber:"cardNumber"};IjsBridge.prototype.extend=function(){throw new NotImplementException},IjsBridge.prototype.addEventListener=function(e,t){throw new NotImplementException},IjsBridge.prototype.dispatchEvent=function(e){throw new NotImplementException},IjsBridge.prototype.removeEventListener=function(e,t){throw new NotImplementException},IjsBridge.prototype.ajax=function(e){throw new NotImplementException},IjsBridge.prototype.scan=function(e){throw new NotImplementException},IjsBridge.prototype.pay=function(e){throw new NotImplementException},IjsBridge.prototype.share=function(e){throw new NotImplementException},IjsBridge.prototype.setAppOptions=function(e){throw new NotImplementException},AjsBridge.prototype=Object.create(IjsBridge.prototype),AjsBridge.prototype.extend=function(){for(var e,t={},n=0;e=arguments[n];n++)if(e&&"object"==typeof e)for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);return t},AjsBridge.prototype.addEventListener=function(e,t){var n=this;n.Listeners.push(new ListenerItem(e,t))},AjsBridge.prototype.dispatchEvent=function(e){var t=this;t.Listeners.forEach(function(t,n,o){t.type===e&&t.listener(e)})},AjsBridge.prototype.removeEventListener=function(e,t){var n=this;n.Listeners.forEach(function(n,o,r){n.type===e&&n.listener===t&&r.splice(o,1)})},AjsBridge.prototype.ajax=function(e){var t=this,n=t.extend(e,new AjaxOptions);try{var o=new XMLHttpRequest,r=e.url+(n.cache?"":"&_timestamp="+Date.now());o.open(n.method,r),o.setRequestHeader("Accept","application/json"),o.addEventListener("load",function(t){var n=o.responseText;if(0===n.indexOf("<"))return void console.log(n);var r=JSON.parse(n);e.onSuccess(r)}),o.addEventListener("error",function(t){console.log(t.message),e.onError&&e.onError(this)}),o.addEventListener("loadend",function(t){e.onComplete&&e.onComplete(this)}),o.send(e.data)}catch(i){t.logger.write("xhr Error:"+i.message)}},AjsBridge.prototype.setAppOptions=function(e){this.appOptions=this.extend(new AppOptions,e)},AjsBridge.prototype.defaultScanOptions={scanType:ScanType.qrCode,complete:function(e){console.log(e)}},AjsBridge.prototype.defaultPayOptions={complete:function(e){}},AjsBridge.prototype.defaultShareOptions={complete:function(e){}},AlipayBridge.prototype=Object.create(AjsBridge.prototype),AlipayBridge.prototype._listenAlipayReady=function(){var e=this;document.addEventListener("AlipayJSBridgeReady",function(){e.dispatchEvent(BridgeEventType.ready)},!1)},AlipayBridge.prototype.scan=function(e){if(!e)throw new ArgumentException("scanOptions");var t=this,n=t.extend(t.defaultScanOptions,e),o={type:"qr"};switch(n.scanType){case ScanType.barCode:o.type="bar";break;case ScanType.qrCode:o.type="qr";break;case ScanType.cardNumber:o.type="card"}AlipayJSBridge.call("scan",o,function(e){n.complete(e[n.scanType])})},AndroidBridge.prototype=Object.create(AjsBridge.prototype),AndroidBridge.prototype._andriodReady=function(){var e=this;e.dispatchEvent(BridgeEventType.ready)},AndroidBridge.prototype.scan=function(e){if(!e)throw new ArgumentException("options");var t=this,n=t.extend(t.defaultScanOptions,e);if(n.scanType===ScanType.cardNumber)throw new UnSupportedException("cardNumber");t.options=n,device.scanQRcode()},H5Bridge.prototype=Object.create(AjsBridge.prototype),H5Bridge.prototype._h5Ready=function(){var e=this;e.dispatchEvent(BridgeEventType.ready)},H5Bridge.prototype.scan=function(e){var t=this,n=t.extend(t.defaultScanOptions,e);n.complete("Not Implement!")},IosBridge.prototype=Object.create(AjsBridge.prototype),IosBridge.prototype._iosReady=function(){var e=this;e.dispatchEvent(BridgeEventType.ready)},IosBridge.prototype.scan=function(e){if(!e)throw new ArgumentException("options");var t=this,n=t.extend(t.defaultScanOptions,e);if(n.scanType===ScanType.cardNumber)throw new UnSupportedException("cardNumber");t.options=n,JSModel.callQrReaderView()},WechatBridge.prototype=Object.create(AjsBridge.prototype),WechatBridge.prototype._onWechatReady=function(){var e=this;wx.ready(function(){e.dispatchEvent(BridgeEventType.ready)})},WechatBridge.prototype._listenWechatError=function(){var e=this;wx.error(function(t){e.logger.write(JSON.stringify(t))})},WechatBridge.prototype._remoteGetConfig=function(){var e=this;e.ajax({url:ContainerBridgeConfig.wechatSignatureApiUrl+"?appid="+e.appOptions.appId+"&secret="+e.appOptions.appSecret+"&url="+encodeURIComponent(location.href.split("#")[0]),method:"GET",onSuccess:function(t){var n=t,o={debug:ContainerBridgeConfig.debug,appId:n.AppId,timestamp:n.TimeStamp,nonceStr:n.Noncestr,signature:n.Signature,jsApiList:ContainerBridgeConfig.wechatAPIList};e.logger.write(JSON.stringify(o)),wx.config(o)}})},WechatBridge.prototype.scan=function(e){var t=this,n=t.extend(t.defaultScanOptions,e),o={needResult:1,scanType:["qrCode","barCode"],success:function(e){n.complete(e.resultStr)},fail:function(e){},complete:function(e){},cancel:function(e){}};if(n.scanType===ScanType.cardNumber)throw new UnSupportedException("Wechat UnSupportedException cardNumber");o.scanType=n.scanType,wx.scanQRCode(o)},WechatBridge.prototype.setAppOptions=function(e){var t=this;AjsBridge.prototype.setAppOptions.call(this,e),t._remoteGetConfig()},RelBridge.prototype=Object.create(AjsBridge.prototype),RelBridge.prototype._relReady=function(){var e=this;rel.ready(function(){e.dispatchEvent(BridgeEventType.ready)})},RelBridge.prototype._listenrelError=function(){var e=this;rel.error(function(t){e.logger.write(JSON.stringify(t))})},RelBridge.prototype._remoteGetConfig=function(){var e=this;e.ajax({url:ContainerBridgeConfig.relSignatureApiUrl+"?url="+encodeURIComponent(location.href.split("#")[0]),method:"GET",onSuccess:function(t){var n=t.result,o={debug:ContainerBridgeConfig.debug?1:0,appid:n.AppId,timestamp:n.TimeStamp,nonceStr:n.Noncestr,signature:n.Signature};e.logger.write(JSON.stringify(t)),rel.init(o)}})},RelBridge.prototype.scan=function(e){var t=this,n=t.extend(t.defaultScanOptions,e),o={Needdeal:"0",success:function(e){n.complete(e.errMsg)}};rel.scanQRCode(o)},RelBridge.prototype.share=function(e){var t=this,n=t.extend(t.defaultScanOptions,e);rel.shareMenuItemsCustom({showMenuList:e.showMenuList,success:function(e){n.complete(e.retMsg.result)}})},RelBridge.prototype.pay=function(e){var t=this;rel.chooseRELPay({appid:"",timestamp:"",orderid:"",totalFee:"",nonceStr:"",channelAppNo:"",remark:"",signature:"",success:function(e){e.errMsg},failed:function(e){t.logger.write(e.errMsg)},complete:function(e){t.logger.write(e.errMsg)},cancel:function(e){t.logger.write(e.errMsg)}})},MobileBridge.prototype=Object.create(AjsBridge.prototype),MobileBridge.prototype._MobileReady=function(){var e=this;e.dispatchEvent(BridgeEventType.ready)},MobileBridge.prototype.scan=function(e){var t=this,n=t.extend(t.defaultScanOptions,e);n.complete("Not Implement!")},BridgeFactory.prototype.Create=function(e){var t;return t=/MicroMessenger/gi.test(e)?new WechatBridge:/AlipayClient/gi.test(e)?new AlipayBridge:/AndroidShell/gi.test(e)?new AndroidBridge:/iOSshell/gi.test(e)?new IosBridge:/ICBC/gi.test(e)?new RelBridge:/Android/gi.test(e)?new MobileBridge:/iPhone|iPad|iPod/gi.test(e)?new MobileBridge:new H5Bridge};var ContainerBridge=null;try{ContainerBridge=(new BridgeFactory).Create(window.navigator.userAgent)}catch(e){(new BridgeLogger).write(e.message)}